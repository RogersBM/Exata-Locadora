<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>Lista de Aluguéis</title>
        <link rel="stylesheet" th:href="@{/css/style.css}">
        <script th:src="@{/js/script.js}"></script>

    </head>
    <body>
        <div class="container">
            <h1>Lista de Aluguéis</h1>

            <!-- ✅ MENSAGEM DE SUCESSO -->
            <div th:if="${mensagemSucesso}" class="alert alert-success">
                <p th:text="${mensagemSucesso}"></p>
            </div>

            <!-- ⚠️ MENSAGEM DE ERRO -->
            <div th:if="${mensagemErro}" class="alert alert-error">
                <p th:text="${mensagemErro}"></p>
            </div>

            <!-- ℹ️ MENSAGEM DE INFORMAÇÃO -->
            <div th:if="${mensagemInfo}" class="alert alert-info">
                <p th:text="${mensagemInfo}"></p>
            </div>

            <div class="tabela-container">
                <table border="1">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Cliente</th>
                            <th>Funcionário</th>
                            <th>Equipamento</th>
                            <th>Início</th>
                            <th>Encerramento</th>
                            <th>Total</th>  
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="loc : ${locacoes}">
                            <td th:text="${loc.id}"></td>
                            <td th:text="${loc.cli.nome}"></td>
                            <td th:text="${loc.func.nome}"></td>
                            <td th:text="${loc.equip.nome}"></td>
                            <td th:text="${#temporals.format(loc.dataInicio, 'dd/MM/yyyy')}"></td>

                            <!-- ✅ Data de encerramento: -->
                            <td th:text="${loc.dataFim != null ? #temporals.format(loc.dataFim, 'dd/MM/yyyy') : 'Aberto'}"></td>

                            <!-- ✅ Valor total: -->
                            <td th:text="${loc.total != null ? 'R$ ' + #numbers.formatDecimal(loc.total, 1, 'COMMA', 2, 'POINT') : 'R$ 0,00'}"></td>

                            <td>
                                <a th:href="@{/alugueis/editar/{id}(id=${loc.id})}">Editar</a> |
                                <a th:href="@{/alugueis/excluir/{id}(id=${loc.id})}" onclick="return confirm('Excluir?')">Excluir</a> |
                                <a th:href="@{/alugueis/encerrar-form/{id}(id=${loc.id})}">Encerrar</a>
                            </td>
                        </tr>
                    </tbody>

                </table>
            </div>

            <div class="botoes-rodape" style="margin-top: 20px;">
                <a href="/alugueis/cadastro" style="margin-right: 20px; background: #1b66ff; color: white; padding: 10px 20px;">Cadastrar Novo Aluguel</a>
                <a th:href="@{/index}" style="background: #006603; color: white; padding: 10px 20px;">Voltar</a>
            </div>
        </div>

        <footer style="margin-top: 40px;">&copy; Exata Locadora de Equipamentos <br> @Rudy Rogers - Todos os direitos reservados.</footer>

    </body>
</html>
